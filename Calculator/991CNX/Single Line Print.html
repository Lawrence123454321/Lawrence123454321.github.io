<!DOCTYPE html>
<html>
    <head>
        <title>Single Line Print - lliu.fun</title>
        <link rel="stylesheet" href="index.css" />
    </head>
    <body>
        <div class="main">
            <h1>Screen Glitches</h1>
            <p>Here are the procedures for the Single Line Print.</p>
            <h3 id="a-enter-linear-complex-mode">a. Enter Linear Complex Mode</h3>
            <p>First, enter [Linear Mode]: </p>
            <p>[SHIFT] [Menu] [1] [3] </p>
            <p>Enter [Complex Mode] [Menu] [2] </p>
            <h3 id="b-enter-character-converter">b. Enter Character Converter</h3>
            <p>[SHIFT] [8] [Down] [2] [7] [Left] [1] [=] [Up] [Left] </p>
            <h3 id="c-glitch-an-">c. Glitch &#39;an&#39;</h3>
            <p>[SHIFT] [.(decimal point)] [Left] [Left] [Right] [i(imaginary number i(ENG key))] [Left] [9] [DEL] [DEL] [Right] [Right] [DEL] </p>
            <p>At this point, there should be only one <code>an</code> symbol on the screen. Next, move the cursor to <code>an</code> and enter 100 digits (you can use 123456789 to count). </p>
            <p>Then, enter the <code>+</code> sign and continue to enter <code>9</code> digits. </p>
            <blockquote>
            <p>You must have noticed: 
            We want to enter 110 bytes of data, why can&#39;t we just type 110 digits before an? 
            The reason: The 991cnx calculator doesn&#39;t allow numbers larger than 100 digits.
            So we use +123456789 to represent the remaining 10 bytes.
            Thus, <100bytes><1byte(`+`)><9bytes><an> has exactly 110 bytes of data before an!</p>
            </blockquote>
            <p>Press [=]</p>
            <p>As expected, the screen clears, as described above, and a pointer position has been changed.</p>
            <h3 id="d-enter-the-data-we-arranged-previously-">d. Enter the data we arranged previously.</h3>
            <p>Type <code>12345678901234567</code>. This totals 17 bytes, which is the line of characters we want to display.</p>
            <p>Type any 17 single-byte characters (search for them in the first-level single-byte character table). <strong>For convenience, I&#39;ve typed 17 1s here</strong></p>
            <p>Now, we have <34 bytes> of data. Enter the ROP address: FE 20 32 20</p>
            <p>This will output Pa&gt;kgf/cmÂ² 2 0</p>
            <p><code>SHIFT,8,Down,2,6</code> <code>2</code> <code>0</code></p>
            <p>Press the [=] sign:</p>
            <h3 id="e-what-happened-">e. What happened?</h3>
            <p>When [=] is pressed, the input buffer is copied to the space below the stack. After the <34>th byte, the top of the stack is overwritten. Then smart_strcpy POP PC returns. Since the stack is overwritten, the return address is overwritten to: FE 20 32 20. The CPU jumps to 2:20FE to execute.</p>
        </div>
        <script src="../../navbar.js"></script>
    </body>
</html>